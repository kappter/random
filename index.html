<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Random Calculator - Enhanced</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>
    <button class="dark-mode-toggle" id="darkModeToggle">üåô Dark Mode</button>
    <div class="container">
        <h1>Live Random Calculator</h1>
        
        <!-- Algorithm Information Panel -->
        <div class="algorithm-info">
            <h2 id="algorithmName">Algorithm: Pi Digits</h2>
            <div class="algorithm-badges">
                <span class="badge badge-type" id="algorithmType">Deterministic</span>
                <span class="badge badge-distribution" id="algorithmDistribution">Uniform (Expected)</span>
            </div>
            <p id="algorithmDescription">Uses the digits of Pi. While deterministic, Pi digits are expected to be uniformly distributed across all bases.</p>
            
            <!-- New: Detailed Information Section -->
            <div class="algorithm-details">
                <div class="detail-section">
                    <h4>üìö Basic Information</h4>
                    <p id="algorithmBasicInfo">Pi's digits have been studied extensively and appear random despite being deterministic.</p>
                </div>
                <div class="detail-section">
                    <h4>‚öôÔ∏è Technical Details</h4>
                    <p id="algorithmTechnicalInfo">Commonly used in demonstrations and educational contexts. Not suitable for cryptography.</p>
                </div>
                <div class="detail-section">
                    <h4>üí° Common Use Cases</h4>
                    <p id="algorithmUseCases">Education, demonstrations, testing statistical analysis tools.</p>
                </div>
                <div class="detail-section">
                    <h4>üíª Programming Language Usage</h4>
                    <p id="algorithmLanguageUsage">Not used as a default PRNG in any major programming language.</p>
                </div>
            </div>
            
            <!-- Statistics Grid -->
            <div class="stats-grid">
                <div class="stat-item">
                    <span class="stat-label">Mean: <span class="info-icon" title="Average digit value. For uniform distribution in base N, expected mean is (N-1)/2. E.g., base 10 expects ~4.5, base 2 expects ~0.5">‚ÑπÔ∏è</span></span>
                    <span class="stat-value" id="statMean">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Std Dev: <span class="info-icon" title="Standard Deviation measures spread of values. Lower values mean digits cluster near the mean; higher values mean more spread. For uniform distribution, expected ~‚àö((N¬≤-1)/12)">‚ÑπÔ∏è</span></span>
                    <span class="stat-value" id="statStdDev">-</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Chi-Square: <span class="info-icon" title="Chi-Square test measures how well the distribution matches expected uniform distribution. Lower is better. Values < 10 are excellent, < 20 are good. High values indicate non-uniform patterns">‚ÑπÔ∏è</span></span>
                    <span class="stat-value" id="statChiSquare">-</span>
                </div>
            </div>
        </div>

        <!-- Base System Selector -->
        <div class="control-group">
            <label for="baseSystem">Number Base (2-16):</label>
            <input type="number" id="baseSystem" min="2" max="16" value="10">
            <button onclick="applyBase()">Apply Base</button>
            <button onclick="randomizeSettings()" class="random-btn">üé≤ Random</button>
            <span class="badge badge-info" id="baseInfo">Base 10 (Decimal)</span>
        </div>

        <!-- Controls -->
        <div class="control-group">
            <label for="digits">Number of Digits (100-10000):</label>
            <input type="number" id="digits" min="100" max="10000" value="100" step="100">
        </div>

        <div class="control-group">
            <label for="calcType">Algorithm:</label>
            <select id="calcType" onchange="handleAlgorithmChange()">
                <option value="pi">Pi Digits</option>
                <option value="gaussian">Gaussian Distribution</option>
                <option value="perlin">Perlin Noise</option>
                <option value="lcg">Linear Congruential Generator</option>
                <option value="mersenne">Mersenne Twister</option>
                <option value="logistic">Logistic Map</option>
                <option value="middleSquare">Middle-Square Method</option>
                <option value="xorshift">Xorshift</option>
                <option value="quantum">Quantum Random (API)</option>
                <option value="rule30">Cellular Automaton Rule 30</option>
                <optgroup label="File Analysis">
                    <option value="fileUpload">üìÇ Upload File (Byte Analysis)</option>
                </optgroup>
            </select>
        </div>

        <!-- File Upload Zone (shown only when fileUpload algorithm is selected) -->
        <div id="fileUploadZone" class="file-upload-zone" style="display:none;">
            <div id="dropZone" class="drop-zone" ondrop="handleFileDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">
                <div class="drop-zone-icon">üìÇ</div>
                <div class="drop-zone-text">Drag &amp; drop a file here</div>
                <div class="drop-zone-subtext">or</div>
                <label class="file-select-btn">
                    Browse File
                    <input type="file" id="fileInput" onchange="handleFileSelect(event)" style="display:none;">
                </label>
                <div class="drop-zone-limit">Max 2MB &bull; Any file type</div>
            </div>
            <!-- File Info Panel (shown after file is loaded) -->
            <div id="fileInfoPanel" class="file-info-panel" style="display:none;">
                <div class="file-info-header">
                    <span class="file-icon" id="fileTypeIcon">üìÑ</span>
                    <div class="file-info-details">
                        <div class="file-name" id="fileName">filename.txt</div>
                        <div class="file-meta" id="fileMeta">0 KB &bull; text/plain</div>
                    </div>
                    <button class="file-clear-btn" onclick="clearUploadedFile()">‚úï Clear</button>
                </div>
                <div class="file-entropy-grid">
                    <div class="file-entropy-item">
                        <div class="file-entropy-label">Total Bytes</div>
                        <div class="file-entropy-value" id="fileTotalBytes">0</div>
                    </div>
                    <div class="file-entropy-item">
                        <div class="file-entropy-label">Hex Digits Available</div>
                        <div class="file-entropy-value" id="fileHexDigits">0</div>
                    </div>
                    <div class="file-entropy-item">
                        <div class="file-entropy-label">Entropy Class</div>
                        <div class="file-entropy-value" id="fileEntropyClass">‚Äî</div>
                    </div>
                    <div class="file-entropy-item">
                        <div class="file-entropy-label">Unique Bytes</div>
                        <div class="file-entropy-value" id="fileUniqueBytes">0</div>
                    </div>
                </div>
                <div class="file-entropy-insight" id="fileEntropyInsight"></div>
            </div>
        </div>

        <div class="control-group">
            <label for="updateFrequency">Update Frequency:</label>
            <select id="updateFrequency">
                <option value="Every 1 digit" selected>Every 1 digit</option>
                <option value="Every 10 digits">Every 10 digits</option>
                <option value="Every 50 digits">Every 50 digits</option>
                <option value="Every 100 digits">Every 100 digits</option>
                <option value="Every 500 digits">Every 500 digits</option>
            </select>
        </div>

        <div class="control-group">
            <label for="speedControl">Generation Speed: <span id="speedValue">100ms</span></label>
            <input type="range" id="speedControl" min="10" max="1000" value="100" step="10">
            <div class="speed-labels">
                <span>Fast (10ms)</span>
                <span>Slow (1000ms)</span>
            </div>
        </div>

        <div class="button-group">
            <button onclick="calculate()">Calculate</button>
            <button id="stepBtn" onclick="stepGeneration()">Step</button>
            <button id="pauseBtn" onclick="pauseResume()">Pause</button>
            <button onclick="reset()">Reset</button>
        </div>

        <!-- Guess Section -->
        <div id="guessSection" class="guess-section">
            <h3>Guess Which Digit Will Win</h3>
            <div class="bet-type-selection">
                <label class="bet-type-label">Betting on:</label>
                <div class="radio-group">
                    <label class="radio-label">
                        <input type="radio" name="betType" value="tally" checked>
                        <span>Most Tallies (Final Count)</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="betType" value="leadTime">
                        <span>Most Lead Time (Iterations in Lead)</span>
                    </label>
                    <label class="radio-label">
                        <input type="radio" name="betType" value="ghost">
                        <span>üëª Highest Ghost Score (Most Count, Never Led)</span>
                    </label>
                </div>
            </div>
            <div class="guess-input-group">
                <input type="text" id="guess" placeholder="Enter digit (e.g., 0-9, A, B)" maxlength="1">
                <button id="submitGuess" onclick="submitGuess()">Submit Guess</button>
            </div>
            <button onclick="toggleGuessSection()">Hide Guess Section</button>
            <p id="guessResult"></p>
        </div>

        <!-- Status Bar -->
        <div class="status-bar">
            <span>Live Digit: <strong id="liveDigit">Not started</strong></span>
            <span>Processed: <strong id="processedCount">0</strong> digits</span>
        </div>

        <!-- Chart Containers -->
        <div class="chart-container">
            <canvas id="digitChart"></canvas>
        </div>
        
        <!-- View Toggle -->
        <div class="view-toggle">
            <button id="timeSeriesBtn" class="toggle-btn active" onclick="showTimeSeriesView()">üìà Time Series</button>
            <button id="spiralBtn" class="toggle-btn" onclick="showSpiralView()">üåÄ Spiral</button>
            <button id="leadTimeBtn" class="toggle-btn" onclick="showLeadTimeView()">üëë Lead Time</button>
        </div>
        
        <div class="chart-container" id="timeSeriesContainer">
            <canvas id="timeSeriesChart"></canvas>
        </div>
        
        <div class="chart-container" id="spiralContainer" style="display:none;">
            <canvas id="spiralCanvas" width="800" height="800"></canvas>
        </div>
        
        <div class="chart-container" id="leadTimeContainer" style="display:none;">
            <canvas id="leadTimeChart"></canvas>
        </div>

        <!-- Results -->
        <div class="results">
            <div id="summaryReport"></div>
            <div id="detailedAnalysis"></div>
            <div id="printReportBtn" style="display:none; text-align:center; margin: 16px 0;">
                <button onclick="printReport()" class="print-btn">üñ®Ô∏è Print Report</button>
            </div>
            <div class="digit-output">
                <h3>Generated Digits:</h3>
                <textarea id="digitSequence" readonly placeholder="Digits will appear here as they are generated..."></textarea>
                <button onclick="copyDigits()">Copy Digits</button>
            </div>
        </div>
    </div>

    <!-- Printable Report (hidden until triggered) -->
    <div id="printableReport" class="printable-report" style="display:none;">
        <div class="print-header">
            <div class="print-title-block">
                <h1 class="print-title">Live Random Calculator</h1>
                <p class="print-subtitle">Experiment Results Report</p>
            </div>
            <div class="print-meta">
                <span id="printDate"></span>
            </div>
        </div>
        <div class="print-run-info">
            <table class="print-info-table">
                <tr>
                    <td><strong>Algorithm:</strong> <span id="printAlgorithm"></span></td>
                    <td><strong>Base:</strong> <span id="printBase"></span></td>
                    <td><strong>Digits Generated:</strong> <span id="printDigitCount"></span></td>
                    <td><strong>Chi-Square:</strong> <span id="printChiSquare"></span></td>
                </tr>
            </table>
        </div>
        <div class="print-champions">
            <h2 class="print-section-title">üèÜ Champions</h2>
            <div class="print-champions-grid">
                <div class="print-champion-card tally-card">
                    <div class="print-champion-icon">‚úÖ</div>
                    <div class="print-champion-label">Final Count Winner</div>
                    <div class="print-champion-value" id="printTallyChamp"></div>
                </div>
                <div class="print-champion-card lead-card">
                    <div class="print-champion-icon">üëë</div>
                    <div class="print-champion-label">Lead Time Champion</div>
                    <div class="print-champion-value" id="printLeadChamp"></div>
                </div>
                <div class="print-champion-card ghost-card">
                    <div class="print-champion-icon">üëª</div>
                    <div class="print-champion-label">Ghost Champion</div>
                    <div class="print-champion-value" id="printGhostChamp"></div>
                </div>
            </div>
        </div>
        <div id="printAnomalyBlock" class="print-anomaly" style="display:none;">
            <h2 class="print-anomaly-title">üö® Anomaly Detected</h2>
            <p id="printAnomalyText"></p>
        </div>
        <div id="printGuessBlock" class="print-guess-block" style="display:none;">
            <h2 class="print-section-title">üéØ Your Guess</h2>
            <p id="printGuessText"></p>
        </div>
        <div class="print-stats">
            <h2 class="print-section-title">üìä Full Statistics</h2>
            <table class="print-stats-table">
                <thead>
                    <tr>
                        <th>Digit</th>
                        <th>Occurrences</th>
                        <th>% of Total</th>
                        <th>Lead Time (iters)</th>
                        <th>Ghost Score</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody id="printStatsBody"></tbody>
            </table>
        </div>
        <div class="print-narrative">
            <h2 class="print-section-title">üìù Analysis</h2>
            <p id="printNarrative"></p>
        </div>
        <div class="print-footer">
            <p>Generated by Live Random Calculator &mdash; Educational Tool for Algorithm Analysis</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
